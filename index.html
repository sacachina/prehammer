
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<title>拍賣研究面板</title>
<style>
/* 基础样式（不影响你已有逻辑） */
body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;margin:0;padding:20px;background:#fafafa}
.card{border:1px solid #e5e7eb;border-radius:14px;padding:16px;margin:16px 0;background:#fff}
.h2{font-size:18px;font-weight:600}
.muted{color:#6b7280;font-size:13px}

/* 评论滚动（保持你之前成功的行为） */
#commentList{max-height:320px;overflow-y:auto}

/* 拍卖资料库 */
#notesGrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:14px;margin-top:12px}
.noteCard{border:1px solid #e5e7eb;border-radius:10px;overflow:hidden;text-decoration:none;color:#111;background:#fff}
.noteThumb{aspect-ratio:4/3;background:#f3f4f6}
.noteThumb img{width:100%;height:100%;object-fit:cover}
.noteTitle{padding:8px 10px;font-size:13px;line-height:1.4}

/* Modal */
#noteModal{display:none}
#noteModal .mask{position:fixed;inset:0;background:rgba(0,0,0,.45)}
#noteModal .box{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border-radius:14px;padding:20px;width:min(720px,90vw)}
</style>
</head>
<body>

<!-- 这里假设你原有投票 / 评论区已经存在 -->

<div class="card">
  <div class="h2">拍賣資料庫｜最新動態</div>
  <div class="muted">近期香港與國際重要拍賣成交與流拍記錄</div>
  <div id="notesGrid"></div>
</div>

<div id="noteModal">
  <div class="mask" onclick="closeModal()"></div>
  <div class="box">
    <h3 id="mTitle"></h3>
    <p id="mExcerpt"></p>
    <a id="mLink" target="_blank">閱讀原文</a>
  </div>
</div>

<script>
async function loadNotes(){
  const r = await fetch("/notes?limit=10&ts="+Date.now());
  const j = await r.json();
  const g = document.getElementById("notesGrid");
  if(!j || !j.ok){ g.innerHTML=""; return; }
  g.innerHTML = j.items.map(it=>`
    <a class="noteCard" href="javascript:void(0)" onclick="openModal('${it.slug}')">
      <div class="noteThumb">${it.image?`<img src="${it.image}">`:""}</div>
      <div class="noteTitle">${it.title}</div>
    </a>
  `).join("");
}
async function openModal(slug){
  const r = await fetch("/notes?slug="+slug+"&ts="+Date.now());
  const j = await r.json();
  if(!j || !j.ok) return;
  document.getElementById("mTitle").textContent = j.note.title;
  document.getElementById("mExcerpt").textContent = j.note.excerpt || "";
  document.getElementById("mLink").href = j.note.url;
  document.getElementById("noteModal").style.display="block";
}
function closeModal(){ document.getElementById("noteModal").style.display="none"; }

loadNotes();
</script>

</body>
</html>
